/* eslint-disable global-require */
/* eslint-disable import/no-dynamic-require */
const fs = require('fs');
const path = require('path');

/**
 * 检查文件是否存在
 * @param {*} file
 * @returns boolean
 */
function isFileExist(file) {
  let result = true;
  try {
    fs.statSync(file);
  } catch (e) {
    result = false;
  }
  return result;
}

/**
 * 获取eslint配置文件路径
 * @returns string eslint配置文件路径
 */
function getEslintConfigFilePath() {
  const userEslintConfigJSFile = path.resolve(process.cwd(), '.eslintrc.js');
  const userEslintConfigJSONFile = path.resolve(process.cwd(), '.eslintrc.json');
  const userEslintConfigYMLFile = path.resolve(process.cwd(), '.eslintrc.yml');
  let eslintConfig = path.join(__dirname, './../tasks/config/.eslintrc.js');
  if (isFileExist(userEslintConfigYMLFile)) {
    eslintConfig = userEslintConfigYMLFile;
  }
  if (isFileExist(userEslintConfigJSONFile)) {
    eslintConfig = userEslintConfigJSONFile;
  }
  if (isFileExist(userEslintConfigJSFile)) {
    eslintConfig = userEslintConfigJSFile;
  }
  return eslintConfig;
}

function getUniFile() {
  const userUniJSFile = path.resolve(process.cwd(), '.unirc.js');
  const userUniJSONFile = path.resolve(process.cwd(), '.unirc.json');
  let config = {};
  if (isFileExist(userUniJSFile)) {
    config = require(userUniJSFile);
  }
  if (isFileExist(userUniJSONFile)) {
    config = require(userUniJSONFile);
  }
  return config;
}

module.exports = {
  isFileExist,
  getEslintConfigFilePath,
  getUniFile,
};
