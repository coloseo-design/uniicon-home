const path = require('path');
/**
 * env默认为process.env，是宿主环境的process
 * 把npx可执行的命令添加到命令环境中
 */
function getRunCmdEnv() {
  const env = {};
  Object.assign(env, {
    ...process.env,
  });
  const nodeModulesBinDir = path.join(__dirname, '../../node_modules/.bin');
  const keys = Object.keys(env).filter((key) => key.toLowerCase() === 'path');
  // 把node_moduls下的bin添加到path中
  if (keys.length) {
    const key = keys[0];
    env[key] = env[key] ? `${nodeModulesBinDir}:${env[key]}` : nodeModulesBinDir;
  }
  return env;
}
module.exports = getRunCmdEnv;
