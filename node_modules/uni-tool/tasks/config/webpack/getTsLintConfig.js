/* eslint-disable @typescript-eslint/no-var-requires */
/* eslint-disable global-require */
/* eslint-disable import/no-dynamic-require */
const chalk = require('chalk');
const path = require('path');
const { isFileExist } = require('../../../utils/file.js');

/**
 * 加载tslint配置文件
 * 如果在指定工作目录[workspace]下存在tslint.json则使用指定的tslint
 * 否则加载默认的tslint配置文件
 * @param {*} workspace
 * @author luobodng
 */
module.exports.getTSlintConfig = function getTSlintConfig(workspace) {
  let configFilePath = '../.eslintrc.js';
  process.stdout.write(chalk.yellow('加载工作目录的eslint配置文件\n'));
  const eslintJSONConfigFileName = path.resolve(workspace, '.eslintrc.json');
  const eslintJSConfigFileName = path.resolve(workspace, '.eslintrc.js');
  if (isFileExist(eslintJSONConfigFileName)) {
    configFilePath = eslintJSONConfigFileName;
  } else if (isFileExist(eslintJSConfigFileName)) {
    configFilePath = eslintJSConfigFileName;
  } else {
    process.stdout.write(chalk.yellow('加载工作目录的.eslintrc.json失败, 尝试使用默认的tslint配置...\n'));
  }
  return require(configFilePath);
};
